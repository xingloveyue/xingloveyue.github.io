<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>错误异常处理与面向对象 | cgjil</title><meta name="keywords" content="语言"><meta name="author" content="cgjil"><meta name="copyright" content="cgjil"><meta name="referrer" content="no-referrer"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="错误异常处理与面向对象"><meta name="application-name" content="错误异常处理与面向对象"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="错误异常处理与面向对象"><meta property="og:url" content="http://example.com/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/index.html"><meta property="og:site_name" content="cgjil"><meta property="og:description" content="基本概念Python 异常当程序运行时，因为遇到未知的错误而导致中止运行，便会出现Traceback 消息，打印异常。异常即是一个事件，该事件会在程序执行过程中发生，影响程序的正常执行。一般情况下，在Python 无法正常处理程序时就会发生一个异常。异常是Python 对象，表示一个错误。当Pyth"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://example.com/image/5.webp"><meta property="article:author" content="cgjil"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/image/5.webp"><meta name="description" content="基本概念Python 异常当程序运行时，因为遇到未知的错误而导致中止运行，便会出现Traceback 消息，打印异常。异常即是一个事件，该事件会在程序执行过程中发生，影响程序的正常执行。一般情况下，在Python 无法正常处理程序时就会发生一个异常。异常是Python 对象，表示一个错误。当Pyth"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"><link rel="preconnect" href="//npm.elemecdn.com"/><link rel="preconnect" href="//npm.onmicrosoft.cn"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: {"enable":true,"ck":"3G1uPFWikrp3ggY5","LingQueMonitorID":"3G1uPFWikrp3ggY5"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🏃 脚踏实地行动派"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: cgjil","link":"链接: ","source":"来源: cgjil","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'cgjil',
  title: '错误异常处理与面向对象',
  postAI: '',
  pageFillDescription: '基本概念, Python 异常, 检测（捕获）异常, try except 语句, 捕获多种异常, 捕获所有异常, 处理异常, 特殊场景, with 语句, 内网主机存活检测程序, scapy 模块, 主要功能, scapy 安装, 进入scapy 模块, 简单使用, 主机存活检测程序, 面向对象编程, 类, 创建类, init 方法, 方法, 绑定方法, 继承, 子类继承, 方法重写, 多重继承, 魔法函数, 类和实例的内建函数, 常用的魔法函数, 私有化基本概念异常当程序运行时因为遇到未知的错误而导致中止运行便会出现消息打印异常异常即是一个事件该事件会在程序执行过程中发生影响程序的正常执行一般情况下在无法正常处理程序时就会发生一个异常异常是对象表示一个错误当脚本发生异常时我们需要响应处理它否则程序会终止执行异常描述语法错误未声明初始化对象序列中没有此索引用户中断执行没有内建输入到达标记不适用系统输入输出操作失败当操作或函数接收到具有正确类型但值不适合的参数并且情况不能用更精确的异常例如来描述时将被引发字符串与整数相加时触发检测捕获异常如果一个语句发生了错误或异常跳过该语句的执行执行另外的语句语句尝试执行语句如果遇到异常行不通则执行语句两个语句执行执行一个语法规则监控这里的异常异常处理代码示例异常初探捕获多种异常算命脚本输入年龄预测明年的年龄可以把多个语句连接在一起处理一个块中可能发生的多种异常捕获多种异常杰哥的算命脚本预测年龄预测财运预测姻缘好好学习捕获所有异常如果出现的异常没有出现在指定要捕获的异常列表中程序仍然会中断可以使用在异常继承的树结构中是在最顶层的所以使用它可以捕获任意类型的异常捕获所有异常相当于异常树所有异常的基类解释器请求退出用户中断执行通常是输入生成器调用方法时触发的常规错误的基类异常都是从基类继承的迭代器没有更多的值所有的内建标准异常的基类缓冲区操作不能执行所有数值计算错误的基类浮点计算错误数值运算超出最大限制除或取模零所有数据类型断言语句失败访问未知对象属性操作系统错误的基类输入输出错误操作系统错误系统调用失败系统调用失败没有内建输入到达标记导入模块对象失败无效数据查询的基类键值不存在引发的异常索引超出范围字典关键字不存在内存溢出错误对于解释器不是致命的未声明初始化对象没有属性访问未初始化的本地变量弱引用试图访问已经垃圾回收了的对象一般的运行时错误尚未实现的方法语法错误缩进错误和空格混用一般的解释器系统错误对类型无效的操作传入无效的参数相关的错误解码时的错误编码时错误转换时错误警告的基类关于被弃用的特征的警告关于特性将会被废弃的警告可疑的运行时行为的警告可疑的语法的警告用户代码生成的警告关于构造将来语义会有改变的警告关于模块进口可能出现错误的警告的基类有关警告的基类有关字节警告相关的基类处理异常尝试执行某个语句如果遇到异常执行的语句如果没有遇到异常执行的语句不管是否遇到异常都要执行的语句子句在范围中没有异常被检测到时执行子句在范围中的任何代码运行前范围中的所有代码必须完全成功子句子句是无论异常是否发生是否捕捉都会执行的一段代码比如获取用户的输入写入文件但是如果在获取数据过程中发生了异常就会导致整个脚本结束执行文件也无法关闭了为了解决这个问题可以采用异常处理中的子句也就是说无论语句是否正常执行都需要关闭处理异常杰哥的算命脚本预测年龄预测财运预测姻缘好好学习脚本执行结束祝你好运特殊场景语句语句是用来简化代码的比如在将打开文件的操作放在语句中代码块结束后文件将自动关闭用来简化文件操作的打开和关闭其中属性是判断文件是否被关闭的内网主机存活检测程序模块与有非常大的区别是一个的第三方模块被称为网络神器模块能够发送捕获分析和铸造网络数据包主要功能安装下安装中自带环境进入模块简单使用构造数据包发送数据包发送数据包的函数说明发送数据包接收所有返回包发送数据包接收一个返回包发送数据包不等待返回包发送层数据包等待回应发送层数据包不等待返回包查看返回包主机存活检测程序内网主机存活检测程序面向对象编程类类是一类事物的统称比如学生对象就是类的实例化类有属性变量比如学生的姓名性别年龄成绩等也就是编程里面的变量类有方法函数比如学生的上课下课等也就是编程里面的函数创建类类是一种数据结构我们可以用它来定义对象对象把数据值和行为特性融合在一起使用关键字来创建类通常类名的第一个字母大写推荐使用驼峰式命名法单词首字母均大写类有属性变量和方法动作函数组成类文档字符串类体方法是类的实例对象创建后第一个被调用的方法通常被用来进行对象中属性变量的初始化设置实例的属性可以在实例创建后任意时间进行但是通常情况下优先在方法中实现定义类型实例化对象创建一个对象初始化对象第一次给对象属性赋值的成绩是方法绑定方法方法仅仅是类内部定义的函数方法只有在其所属的类拥有实例时才能被调用任何一个方法定义中的第一个参数都是变量它表示调用此方法的实例对象就是自己类中的方法也就是类中定义的函数这个函数第一个参数永远是表示自己绑定方法的成绩是好好学习中继承子类继承继承描述了基类祖先的属性如何遗传给派生类子孙子类可以继承它的基类的任何属性不管是数据属性还是方法子类继承玩游戏中的成绩是好好学习中方法重写如果子类中有和父类同名的方法父类方法将被覆盖如果需要访问父类的方法则要调用一个未绑定的父类方法明确给出子类的实例方法重写玩游戏中的成绩是好好学习中玩王者荣耀中多重继承允许多重继承即一个类可以是多个父类的子类子类可以拥有所有父类的属性多重继承魔法函数类和实例的内建函数函数作用判断一个类是另一个类的子类或子孙类判定一个对象是否是另一个给定类的实例判断一个对象是否有一个特定的属性获得一个对象的属性值设置一个对象的属性删除一个对象的属性常用的魔法函数魔法函数是系统自带的会在恰当的时候自动调用魔术方法私有化为类元素属性和方法的私有性提供初步的形式由双下划线开始的属性在运行时被混淆所以直接访问是不允许的私有化绑定方法的成绩是好好学习中',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-28 19:51:39',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://hbimg.huaban.com/535ad5a8d0a1762fc1cbe65f6e7748d373a8c57d7bfa-l5D3wU_fw658"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">cgjil</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>3</sup></a><a href="/tags/Windows/" style="font-size: 1.05rem;">Windows<sup>4</sup></a><a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size: 1.05rem;">脚本<sup>1</sup></a><a href="/tags/%E8%AF%AD%E8%A8%80/" style="font-size: 1.05rem;">语言<sup>6</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">十一月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">十月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">九月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/07/"><span class="card-archive-list-date">七月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/06/"><span class="card-archive-list-date">六月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url">编程</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E8%AF%AD%E8%A8%80/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>语言</span></a></span></div></div><h1 class="post-title" itemprop="name headline">错误异常处理与面向对象</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2022-10-28T11:51:39.000Z" title="发表于 2022-10-28 19:51:39">2022-10-28</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2022-10-28T11:51:39.000Z" title="更新于 2022-10-28 19:51:39">2022-10-28</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">3.6k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator"></span><span id="" data-flag-title="错误异常处理与面向对象"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span class="waline-pageview-count" data-path="/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" title="访问量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#post-comment"><span class="waline-comment-count" data-path="/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"><header><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url">编程</a><a href="/tags/%E8%AF%AD%E8%A8%80/" tabindex="-1" itemprop="url">语言</a><h1 id="CrawlerTitle" itemprop="name headline">错误异常处理与面向对象</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">cgjil</span><time itemprop="dateCreated datePublished" datetime="2022-10-28T11:51:39.000Z" title="发表于 2022-10-28 19:51:39">2022-10-28</time><time itemprop="dateCreated datePublished" datetime="2022-10-28T11:51:39.000Z" title="更新于 2022-10-28 19:51:39">2022-10-28</time></header><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><h3 id="Python-异常"><a href="#Python-异常" class="headerlink" title="Python 异常"></a>Python 异常</h3><p>当程序运行时，因为遇到未知的错误而导致中止运行，便会出现Traceback 消息，打印异常。异常即是一个事件，该事件会在程序执行过程中发生，影响程序的正常执行。一般情况下，在Python 无法正常处理程序时就会发生一个异常。异常是Python 对象，表示一个错误。当Python 脚本发生异常时我们需要响应处理它，否则程序会终止执行。</p>
<table>
<thead>
<tr>
<th>异常</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>SyntaxError</td>
<td>语法错误</td>
</tr>
<tr>
<td>NameError</td>
<td>未声明&#x2F;初始化对象</td>
</tr>
<tr>
<td>IndexError</td>
<td>序列中没有此索引</td>
</tr>
<tr>
<td>KeyboardInterrupt</td>
<td>用户中断执行（Ctrl+C）</td>
</tr>
<tr>
<td>EOFError</td>
<td>没有内建输入，到达EOF 标记（Ctrl+D） 不适用windows 系统</td>
</tr>
<tr>
<td>IOError</td>
<td>输入&#x2F;输出操作失败</td>
</tr>
<tr>
<td>ValueError</td>
<td>当操作或函数接收到具有正确类型但值不适合的参数， 并且情况不能用更精确的异常，例如 IndexError来描述时将被引发。</td>
</tr>
<tr>
<td>TypeError</td>
<td>字符串与整数相加时触发。</td>
</tr>
</tbody></table>
<h3 id="检测（捕获）异常"><a href="#检测（捕获）异常" class="headerlink" title="检测（捕获）异常"></a>检测（捕获）异常</h3><p>如果一个语句发生了错误或异常，跳过该语句的执行，执行另外的语句。</p>
<h3 id="try-except-语句"><a href="#try-except-语句" class="headerlink" title="try except 语句"></a>try except 语句</h3><p>尝试执行try 语句，如果遇到异常（行不通）则执行except 语句。两个语句执行执行一个。</p>
<p>语法规则</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">pass</span>                <span class="comment"># 监控这里的异常</span></span><br><span class="line"><span class="keyword">except</span> Exception[, reason]:</span><br><span class="line">    <span class="keyword">pass</span>                <span class="comment"># 异常处理代码</span></span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 01 - 异常初探.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    username = <span class="built_in">input</span>(<span class="string">&quot;Please input your name: &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Welcome, <span class="subst">&#123;username&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nSomething Error!&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="捕获多种异常"><a href="#捕获多种异常" class="headerlink" title="捕获多种异常"></a>捕获多种异常</h3><p>算命脚本：输入年龄，预测明年的年龄。</p>
<p>可以把多个except 语句连接在一起，处理一个try 块中可能发生的多种异常。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 02 - 捕获多种异常.py</span></span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">杰哥的算命脚本</span></span><br><span class="line"><span class="string">1. 预测年龄</span></span><br><span class="line"><span class="string">2. 预测财运</span></span><br><span class="line"><span class="string">3. 预测姻缘</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(banner)</span><br><span class="line"></span><br><span class="line">choice = <span class="built_in">input</span>(<span class="string">&quot;Please input the number: &quot;</span>)</span><br><span class="line">choice = <span class="built_in">int</span>(choice)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> choice != <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;好好学习...&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    age = <span class="built_in">input</span>(<span class="string">&quot;Please input your age: &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;The next year your name: <span class="subst">&#123;<span class="built_in">int</span>(age) + <span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> ValueError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Please input a number!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nCtrl + C&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nSomething Error!&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="捕获所有异常"><a href="#捕获所有异常" class="headerlink" title="捕获所有异常"></a>捕获所有异常</h3><p>如果出现的异常没有出现在指定要捕获的异常列表中，程序仍然会中断。可以使用在异常继承的树结构中，BaseException 是在最顶层的，所以使用它可以捕获任意类型的异常。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">except</span> BaseException:           <span class="comment"># 捕获所有异常，相当于except</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nSomething Error!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Pyhton 异常树</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">BaseException                                               所有异常的基类</span><br><span class="line">     |</span><br><span class="line">     |</span><br><span class="line">     +-- SystemExit                                         解释器请求退出</span><br><span class="line">     |</span><br><span class="line">     |</span><br><span class="line">     +-- KeyboardInterrupt                                  用户中断执行(通常是输入^C)</span><br><span class="line">     |</span><br><span class="line">     |</span><br><span class="line">     +-- GeneratorExit                                      生成器调用close();方法时触发的</span><br><span class="line">     |</span><br><span class="line">     |</span><br><span class="line">     +-- Exception                          常规错误的基类，异常都是从基类Exception继承的。</span><br><span class="line">          |</span><br><span class="line">          +-- StopIteration                                 迭代器没有更多的值</span><br><span class="line">          |</span><br><span class="line">          +-- StandardError                                 所有的内建标准异常的基类</span><br><span class="line">          |    +-- BufferError                              缓冲区操作不能执行</span><br><span class="line">          |    +-- ArithmeticError                          所有数值计算错误的基类</span><br><span class="line">          |    |    +-- FloatingPointError                  浮点计算错误</span><br><span class="line">          |    |    +-- OverflowError                       数值运算超出最大限制</span><br><span class="line">          |    |    +-- ZeroDivisionError                   除(或取模)零 (所有数据类型)</span><br><span class="line">          |    +-- AssertionError                           断言语句失败</span><br><span class="line">          |    +-- AttributeError                           访问未知对象属性</span><br><span class="line">          |    +-- EnvironmentError                         操作系统错误的基类</span><br><span class="line">          |    |    +-- IOError                             输入输出错误</span><br><span class="line">          |    |    +-- OSError                             操作系统错误</span><br><span class="line">          |    |         +-- WindowsError (Windows)         系统调用失败</span><br><span class="line">          |    |         +-- VMSError (VMS)                 系统调用失败</span><br><span class="line">          |    +-- EOFError                                 没有内建输入,到达EOF 标记</span><br><span class="line">          |    +-- ImportError                              导入模块/对象失败</span><br><span class="line">          |    +-- LookupError              无效数据查询的基类&amp;#xff0c;键、值不存在引发的异常</span><br><span class="line">          |    |    +-- IndexError                          索引超出范围</span><br><span class="line">          |    |    +-- KeyError                            字典关键字不存在</span><br><span class="line">          |    +-- MemoryError              内存溢出错误(对于Python 解释器不是致命的)</span><br><span class="line">          |    +-- NameError                未声明/初始化对象 (没有属性)</span><br><span class="line">          |    |    +-- UnboundLocalError                   访问未初始化的本地变量</span><br><span class="line">          |    +-- ReferenceError           弱引用(Weak reference)试图访问已经垃圾回收了的对象</span><br><span class="line">          |    +-- RuntimeError                             一般的运行时错误</span><br><span class="line">          |    |    +-- NotImplementedError                 尚未实现的方法</span><br><span class="line">          |    +-- SyntaxError                              语法错误</span><br><span class="line">          |    |    +-- IndentationError                    缩进错误</span><br><span class="line">          |    |         +-- TabError                       Tab 和空格混用</span><br><span class="line">          |    +-- SystemError                              一般的解释器系统错误</span><br><span class="line">          |    +-- TypeError                                对类型无效的操作</span><br><span class="line">          |    +-- ValueError                               传入无效的参数</span><br><span class="line">          |         +-- UnicodeError                        Unicode 相关的错误</span><br><span class="line">          |              +-- UnicodeDecodeError             Unicode 解码时的错误</span><br><span class="line">          |              +-- UnicodeEncodeError             Unicode 编码时错误</span><br><span class="line">          |              +-- UnicodeTranslateError          Unicode 转换时错误</span><br><span class="line">          |</span><br><span class="line">          +-- Warning                                       警告的基类</span><br><span class="line">               +-- DeprecationWarning                       关于被弃用的特征的警告</span><br><span class="line">               +-- PendingDeprecationWarning                关于特性将会被废弃的警告</span><br><span class="line">               +-- RuntimeWarning              可疑的运行时行为(runtime behavior)的警告</span><br><span class="line">               +-- SyntaxWarning                            可疑的语法的警告</span><br><span class="line">               +-- UserWarning                              用户代码生成的警告</span><br><span class="line">               +-- FutureWarning                            关于构造将来语义会有改变的警告</span><br><span class="line">               +-- ImportWarning               关于模块进口可能出现错误的警告的基类。</span><br><span class="line">               +-- UnicodeWarning                           有关Unicode警告的基类。</span><br><span class="line">               +-- BytesWarning                             有关字节警告相关的基类。</span><br></pre></td></tr></table></figure>

<h3 id="处理异常"><a href="#处理异常" class="headerlink" title="处理异常"></a>处理异常</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:                                                <span class="comment"># 尝试执行某个语句</span></span><br><span class="line">    num = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;The number:&quot;</span>))</span><br><span class="line"><span class="keyword">except</span> BaseException:                               <span class="comment"># 如果遇到异常，执行的语句</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;something error!&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:                                               <span class="comment"># 如果没有遇到异常，执行的语句</span></span><br><span class="line">    <span class="built_in">print</span>(num)</span><br><span class="line"><span class="keyword">finally</span>:                                            <span class="comment"># 不管是否遇到异常，都要执行的语句。</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;This is finally&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>else 子句：在try 范围中没有异常被检测到时，执行else 子句。在else 范围中的任何代码运行前，try 范围中的所有代码必须完全成功。</li>
<li>finally 子句：finally 子句是无论异常是否发生，是否捕捉都会执行的一段代码。比如获取用户的输入，写入文件，但是如果在获取数据过程中，发生了异常，就会导致整个脚本结束执行，文件也无法关闭了。为了解决这个问题，可以采用异常处理中的finally 子句，也就是说，无论语句是否正常执行，都需要关闭。</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 03 - 处理异常.py</span></span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">杰哥的算命脚本</span></span><br><span class="line"><span class="string">1. 预测年龄</span></span><br><span class="line"><span class="string">2. 预测财运</span></span><br><span class="line"><span class="string">3. 预测姻缘</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(banner)</span><br><span class="line"></span><br><span class="line">choice = <span class="built_in">input</span>(<span class="string">&quot;Please input the number: &quot;</span>)</span><br><span class="line">choice = <span class="built_in">int</span>(choice)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> choice != <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;好好学习...&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    age = <span class="built_in">input</span>(<span class="string">&quot;Please input your age: &quot;</span>)</span><br><span class="line">    age = <span class="built_in">int</span>(age) </span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> ValueError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Please input a number!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nCtrl + C&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nSomething Error!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;The next year your name: <span class="subst">&#123;age + <span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;脚本执行结束，祝你好运！&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="特殊场景"><a href="#特殊场景" class="headerlink" title="特殊场景"></a>特殊场景</h3><h3 id="with-语句"><a href="#with-语句" class="headerlink" title="with 语句"></a>with 语句</h3><p>with 语句是用来简化代码的。比如在将打开文件的操作放在with 语句中，代码块结束后，文件将自动关闭。用来简化文件操作的打开和关闭，其中closed 属性是判断文件是否被关闭的</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;foo.py&#x27;</span>) <span class="keyword">as</span> f:</span><br></pre></td></tr></table></figure>

<h2 id="内网主机存活检测程序"><a href="#内网主机存活检测程序" class="headerlink" title="内网主机存活检测程序"></a>内网主机存活检测程序</h2><h3 id="scapy-模块"><a href="#scapy-模块" class="headerlink" title="scapy 模块"></a>scapy 模块</h3><p>与scrapy 有非常大的区别。</p>
<p>scapy 是一个Python 的第三方模块，被称为“网络神器”。scapy 模块能够发送、捕获、分析和铸造网络数据包。</p>
<h3 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.assets/v2-52357f80bcb0b3a0393f25849494f3d6_720w.webp" alt="img"></p>
<h3 id="scapy-安装"><a href="#scapy-安装" class="headerlink" title="scapy 安装"></a>scapy 安装</h3><p>Windows 下安装scapy</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">python -m pip install scapy</span><br></pre></td></tr></table></figure>

<p>Kali 中自带scapy 环境。</p>
<h3 id="进入scapy-模块"><a href="#进入scapy-模块" class="headerlink" title="进入scapy 模块"></a>进入scapy 模块</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">┌──(cgji1 zh-CN)-[~]</span><br><span class="line">└─$ sudo scapy                     </span><br><span class="line"></span><br><span class="line">                     aSPY//YASa       </span><br><span class="line">             apyyyyCY//////////YCa       |</span><br><span class="line">            sY//////YSpcs  scpCY//Pp     | Welcome to Scapy</span><br><span class="line"> ayp ayyyyyyySCP//Pp           syY//C    | Version <span class="number">2.4</span><span class="number">.5</span></span><br><span class="line"> AYAsAYYYYYYYY///Ps              cY//S   |</span><br><span class="line">         pCCCCY//p          cSSps y//Y   | https://github.com/secdev/scapy</span><br><span class="line">         SPPPP///a          pP///AC//Y   |</span><br><span class="line">              A//A            cyP////C   | Have fun!</span><br><span class="line">              p///Ac            sC///a   |</span><br><span class="line">              P////YCpc           A//A   | Craft packets before they craft</span><br><span class="line">       scccccp///pSP///p          p//Y   | you.</span><br><span class="line">      sY/////////y  caa           S//P   |                      -- Socrate</span><br><span class="line">       cayCyayP//Ya              pY/Ya   |</span><br><span class="line">        sY/PsY////YCc          aC//Yp </span><br><span class="line">         sc  sccaCY//PCypaapyCP//YSs  </span><br><span class="line">                  spCPY//////YPSps    </span><br><span class="line">                       ccaacs         </span><br><span class="line">                                       using IPython <span class="number">7.22</span><span class="number">.0</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h3><p>构造数据包</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>pkt = IP()/TCP()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pkt.show()</span><br><span class="line"><span class="comment">###[ IP ]### </span></span><br><span class="line">  version   = <span class="number">4</span></span><br><span class="line">  ihl       = <span class="literal">None</span></span><br><span class="line">  tos       = <span class="number">0x0</span></span><br><span class="line">  <span class="built_in">len</span>       = <span class="literal">None</span></span><br><span class="line">  <span class="built_in">id</span>        = <span class="number">1</span></span><br><span class="line">  flags     = </span><br><span class="line">  frag      = <span class="number">0</span></span><br><span class="line">  ttl       = <span class="number">64</span></span><br><span class="line">  proto     = tcp</span><br><span class="line">  chksum    = <span class="literal">None</span></span><br><span class="line">  src       = <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">  dst       = <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">  \options   \</span><br><span class="line"><span class="comment">###[ TCP ]### </span></span><br><span class="line">     sport     = ftp_data</span><br><span class="line">     dport     = http</span><br><span class="line">     seq       = <span class="number">0</span></span><br><span class="line">     ack       = <span class="number">0</span></span><br><span class="line">     dataofs   = <span class="literal">None</span></span><br><span class="line">     reserved  = <span class="number">0</span></span><br><span class="line">     flags     = S</span><br><span class="line">     window    = <span class="number">8192</span></span><br><span class="line">     chksum    = <span class="literal">None</span></span><br><span class="line">     urgptr    = <span class="number">0</span></span><br><span class="line">     options   = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pkt = IP(src = <span class="string">&quot;192.168.1.11&quot;</span>, dst = <span class="string">&quot;192.168.1.1&quot;</span>)/TCP()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pkt.show()</span><br><span class="line"><span class="comment">###[ IP ]### </span></span><br><span class="line">  version   = <span class="number">4</span></span><br><span class="line">  ihl       = <span class="literal">None</span></span><br><span class="line">  tos       = <span class="number">0x0</span></span><br><span class="line">  <span class="built_in">len</span>       = <span class="literal">None</span></span><br><span class="line">  <span class="built_in">id</span>        = <span class="number">1</span></span><br><span class="line">  flags     = </span><br><span class="line">  frag      = <span class="number">0</span></span><br><span class="line">  ttl       = <span class="number">64</span></span><br><span class="line">  proto     = tcp</span><br><span class="line">  chksum    = <span class="literal">None</span></span><br><span class="line">  src       = <span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span></span><br><span class="line">  dst       = <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">  \options   \</span><br><span class="line"><span class="comment">###[ TCP ]### </span></span><br><span class="line">     sport     = ftp_data</span><br><span class="line">     dport     = http</span><br><span class="line">     seq       = <span class="number">0</span></span><br><span class="line">     ack       = <span class="number">0</span></span><br><span class="line">     dataofs   = <span class="literal">None</span></span><br><span class="line">     reserved  = <span class="number">0</span></span><br><span class="line">     flags     = S</span><br><span class="line">     window    = <span class="number">8192</span></span><br><span class="line">     chksum    = <span class="literal">None</span></span><br><span class="line">     urgptr    = <span class="number">0</span></span><br><span class="line">     options   = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>发送数据包</p>
<table>
<thead>
<tr>
<th>发送数据包的函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>sr(pkt)</td>
<td>发送数据包，接收所有返回包</td>
</tr>
<tr>
<td>sr1(pkt)</td>
<td>发送数据包，接收一个返回包</td>
</tr>
<tr>
<td>send(pkt)</td>
<td>发送数据包，不等待返回包</td>
</tr>
<tr>
<td>srp(pkt)</td>
<td>发送2 层数据包，等待回应</td>
</tr>
<tr>
<td>sendp(pkt)</td>
<td>发送2 层数据包，不等待返回包</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>res = sr1(pkt)</span><br><span class="line">Begin emission:</span><br><span class="line">Finished sending <span class="number">1</span> packets.</span><br><span class="line">.*</span><br><span class="line">Received <span class="number">2</span> packets, got <span class="number">1</span> answers, remaining <span class="number">0</span> packets</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>查看返回包</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>res.show()</span><br><span class="line"><span class="comment">###[ IP ]### </span></span><br><span class="line">  version   = <span class="number">4</span></span><br><span class="line">  ihl       = <span class="number">5</span></span><br><span class="line">  tos       = <span class="number">0x0</span></span><br><span class="line">  <span class="built_in">len</span>       = <span class="number">44</span></span><br><span class="line">  <span class="built_in">id</span>        = <span class="number">13990</span></span><br><span class="line">  flags     = </span><br><span class="line">  frag      = <span class="number">0</span></span><br><span class="line">  ttl       = <span class="number">255</span></span><br><span class="line">  proto     = tcp</span><br><span class="line">  chksum    = <span class="number">0x46a4</span></span><br><span class="line">  src       = <span class="number">10.9</span><span class="number">.21</span><span class="number">.1</span></span><br><span class="line">  dst       = <span class="number">10.9</span><span class="number">.21</span><span class="number">.111</span></span><br><span class="line">  \options   \</span><br><span class="line"><span class="comment">###[ TCP ]### </span></span><br><span class="line">     sport     = http</span><br><span class="line">     dport     = ftp_data</span><br><span class="line">     seq       = <span class="number">1510518667</span></span><br><span class="line">     ack       = <span class="number">1</span></span><br><span class="line">     dataofs   = <span class="number">6</span></span><br><span class="line">     reserved  = <span class="number">0</span></span><br><span class="line">     flags     = SA</span><br><span class="line">     window    = <span class="number">65535</span></span><br><span class="line">     chksum    = <span class="number">0x4f9c</span></span><br><span class="line">     urgptr    = <span class="number">0</span></span><br><span class="line">     options   = [(<span class="string">&#x27;MSS&#x27;</span>, <span class="number">1460</span>)]</span><br><span class="line"><span class="comment">###[ Padding ]### </span></span><br><span class="line">        load      = <span class="string">&#x27;\x00\x00&#x27;</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="主机存活检测程序"><a href="#主机存活检测程序" class="headerlink" title="主机存活检测程序"></a>主机存活检测程序</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 04 - 内网主机存活检测程序.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.getLogger(<span class="string">&quot;scapy.runtime&quot;</span>).setLevel(logging.ERROR)</span><br><span class="line"></span><br><span class="line">network = <span class="string">&quot;192.168.1.&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> host <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">    ip = <span class="string">f&quot;<span class="subst">&#123;network&#125;</span><span class="subst">&#123;host&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[-] Trying: <span class="subst">&#123;ip&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    pkt = IP(src = <span class="string">&quot;192.168.1.11&quot;</span>, dst = ip)/ICMP()</span><br><span class="line">    res = sr1(pkt, timeout = <span class="number">0.2</span>, verbose = <span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">if</span> res :</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Alive: <span class="subst">&#123;ip&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="面向对象编程"><a href="#面向对象编程" class="headerlink" title="面向对象编程"></a>面向对象编程</h2><h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><p>类是一类事物的统称，比如学生。对象就是类的实例化。</p>
<p>类有属性（变量），比如学生的姓名、性别、年龄、成绩等，也就是编程里面的变量。</p>
<p>类有方法（函数），比如学生的上课、下课等，也就是编程里面的函数。</p>
<h3 id="创建类"><a href="#创建类" class="headerlink" title="创建类"></a>创建类</h3><p>类是一种数据结构，我们可以用它来定义对象，对象把数据值和行为特性融合在一起。Python 使用<code>class</code> 关键字来创建类：通常类名的第一个字母大写，推荐使用驼峰式命名法，单词首字母均大写。类有属性（变量）和方法（动作，函数）组成。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ClassName</span>(<span class="title class_ inherited__">bases</span>):</span><br><span class="line">    <span class="string">&#x27;class documentation string&#x27;</span>    <span class="comment">#&#x27;类文档字符串&#x27;</span></span><br><span class="line">    class_suite                     <span class="comment"># 类体</span></span><br></pre></td></tr></table></figure>

<h3 id="init-方法"><a href="#init-方法" class="headerlink" title="init 方法"></a><strong>init</strong> 方法</h3><p><code>__init__()</code> 是类的实例（对象）创建后第一个被调用的方法，通常被用来进行对象中属性（变量）的初始化。设置实例的属性可以在实例创建后任意时间进行，但是通常情况下优先在<code>__init__()</code> 方法中实现。</p>
<ul>
<li>定义类型</li>
<li>实例化对象（创建一个对象）</li>
<li>初始化对象（第一次给对象属性赋值）</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 05 - __init__.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stu</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, sex, age, score</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.age = age</span><br><span class="line">        self.score = score</span><br><span class="line"></span><br><span class="line">stu1 = Stu(name = <span class="string">&quot;cgji1&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">24</span>, score = <span class="number">59.9</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;stu1.name&#125;</span> 的成绩是<span class="subst">&#123;stu1.score&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><h3 id="绑定方法"><a href="#绑定方法" class="headerlink" title="绑定方法"></a>绑定方法</h3><p>方法仅仅是类内部定义的函数，方法只有在其所属的类拥有实例时，才能被调用；任何一个方法定义中的第一个参数都是变量self，它表示调用此方法的实例对象就是自己。</p>
<p>类中的方法，也就是类中定义的函数，这个函数第一个参数永远是self，表示自己。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 06 - 绑定方法.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stu</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, sex, age, score</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.age = age</span><br><span class="line">        self.score = score</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getSocre</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;self.name&#125;</span> 的成绩是<span class="subst">&#123;self.score&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">goodGoodStudy</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;好好学习中...&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">10</span>)</span><br><span class="line">        self.score += <span class="number">0.1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stu1 = Stu(name = <span class="string">&quot;cgji1&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">24</span>, score = <span class="number">59.9</span>)</span><br><span class="line">stu2 = Stu(name = <span class="string">&quot;HMM&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">24</span>, score = <span class="number">89.9</span>)</span><br><span class="line"></span><br><span class="line">stu2.getSocre()</span><br><span class="line">stu2.goodGoodStudy()</span><br><span class="line">stu2.getSocre()</span><br></pre></td></tr></table></figure>

<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><h3 id="子类继承"><a href="#子类继承" class="headerlink" title="子类继承"></a>子类继承</h3><p>继承描述了基类（祖先）的属性如何遗传给派生类（子孙），子类可以继承它的基类的任何属性，不管是数据属性还是方法。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 34 - 子类继承.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Kid</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name = <span class="string">&quot;&quot;</span>, sex = <span class="string">&quot;&quot;</span>, age = <span class="string">&quot;&quot;</span></span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">play</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;玩游戏中...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stu</span>(<span class="title class_ inherited__">Kid</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name = <span class="string">&quot;&quot;</span>, sex = <span class="string">&quot;&quot;</span>, age = <span class="string">&quot;&quot;</span>, score = <span class="string">&quot;&quot;</span></span>):</span><br><span class="line">        Kid.__init__(self, name, sex, age)</span><br><span class="line">        self.score = score</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_score</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;self.name&#125;</span> 的成绩是<span class="subst">&#123;self.score&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">good_good_study</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;好好学习中...&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">10</span>)</span><br><span class="line">        self.score += <span class="number">0.1</span></span><br><span class="line"></span><br><span class="line">stu1 = Stu(name = <span class="string">&quot;cgji1&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">24</span>, score = <span class="number">59.9</span>)</span><br><span class="line">stu2 = Stu(name = <span class="string">&quot;LL&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">25</span>, score = <span class="number">49.9</span>)</span><br><span class="line">stu3 = Stu(name = <span class="string">&quot;HMM&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">23</span>, score = <span class="number">99.9</span>)</span><br><span class="line">stu4 = Stu(name = <span class="string">&quot;LH&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">24</span>, score = <span class="number">79.9</span>)</span><br><span class="line"></span><br><span class="line">stu1.play()</span><br></pre></td></tr></table></figure>

<h3 id="方法重写"><a href="#方法重写" class="headerlink" title="方法重写"></a>方法重写</h3><p>如果子类中有和父类同名的方法，父类方法将被覆盖；如果需要访问父类的方法，则要调用一个未绑定的父类方法，明确给出子类的实例。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 08 - 方法重写.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Kid</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, sex, age</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">play</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;玩游戏中...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stu</span>(<span class="title class_ inherited__">Kid</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, sex, age, score</span>):</span><br><span class="line">        Kid.__init__(self, name, sex, age)</span><br><span class="line">        self.score = score</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getSocre</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;self.name&#125;</span> 的成绩是<span class="subst">&#123;self.score&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">goodGoodStudy</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;好好学习中...&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">10</span>)</span><br><span class="line">        self.score += <span class="number">0.1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">play</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;玩王者荣耀中...&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        self.score -= <span class="number">10</span></span><br><span class="line"></span><br><span class="line">stu1 = Stu(name = <span class="string">&quot;cgji1&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">24</span>, score = <span class="number">59.9</span>)</span><br><span class="line">stu2 = Stu(name = <span class="string">&quot;HMM&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">24</span>, score = <span class="number">89.9</span>)</span><br><span class="line"></span><br><span class="line">stu2.getSocre()</span><br><span class="line">stu2.play()</span><br><span class="line">stu2.getSocre()</span><br><span class="line">stu2.goodGoodStudy()</span><br><span class="line">stu2.goodGoodStudy()</span><br><span class="line">stu2.getSocre()</span><br><span class="line">stu2.play()</span><br><span class="line">stu2.getSocre()</span><br></pre></td></tr></table></figure>

<h3 id="多重继承"><a href="#多重继承" class="headerlink" title="多重继承"></a>多重继承</h3><p>Python 允许多重继承，即一个类可以是多个父类的子类，子类可以拥有所有父类的属性。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 09 - 多重继承.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">a</span>():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;This is function A!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">b</span>():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;This is function B!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>(A, B):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">C.a()</span><br><span class="line">C.b()</span><br></pre></td></tr></table></figure>

<h3 id="魔法函数"><a href="#魔法函数" class="headerlink" title="魔法函数"></a>魔法函数</h3><h3 id="类和实例的内建函数"><a href="#类和实例的内建函数" class="headerlink" title="类和实例的内建函数"></a>类和实例的内建函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>issubclass()</td>
<td>判断一个类是另一个类的子类或子孙类</td>
</tr>
<tr>
<td>isinstance()</td>
<td>判定一个对象是否是另一个给定类的实例</td>
</tr>
<tr>
<td>hasattr()</td>
<td>判断一个对象是否有一个特定的属性</td>
</tr>
<tr>
<td>getattr()</td>
<td>获得一个对象的属性值</td>
</tr>
<tr>
<td>setattr()</td>
<td>设置一个对象的属性</td>
</tr>
<tr>
<td>delattr()</td>
<td>删除一个对象的属性</td>
</tr>
</tbody></table>
<h3 id="常用的魔法函数"><a href="#常用的魔法函数" class="headerlink" title="常用的魔法函数"></a>常用的魔法函数</h3><p>魔法函数是系统自带的，会在“恰当”的时候自动调用。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 10 - 魔术方法.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Function __init__ is called!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Why print(self)?&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Why call me like Function?&quot;</span>)</span><br><span class="line"></span><br><span class="line">t = Test()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line">t()</span><br></pre></td></tr></table></figure>

<h3 id="私有化"><a href="#私有化" class="headerlink" title="私有化"></a>私有化</h3><p>Python 为类元素（属性和方法）的私有性提供初步的形式，由双下划线开始的属性在运行时被“混淆”，所以直接访问是不允许的。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 11 - 私有化.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 06 - 绑定方法.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stu</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, sex, age, score</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.age = age</span><br><span class="line">        self.__score = score</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getSocre</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;self.name&#125;</span> 的成绩是<span class="subst">&#123;self.__score&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">goodGoodStudy</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;好好学习中...&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">10</span>)</span><br><span class="line">        self.__score += <span class="number">0.1</span></span><br><span class="line"></span><br><span class="line">stu1 = Stu(name = <span class="string">&quot;cgji1&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">24</span>, score = <span class="number">59.9</span>)</span><br><span class="line">stu2 = Stu(name = <span class="string">&quot;HMM&quot;</span>, sex = <span class="literal">True</span>, age = <span class="number">24</span>, score = <span class="number">89.9</span>)</span><br><span class="line"></span><br><span class="line">stu2.getSocre()</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hbimg.huaban.com/535ad5a8d0a1762fc1cbe65f6e7748d373a8c57d7bfa-l5D3wU_fw658" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hbimg.huaban.com/535ad5a8d0a1762fc1cbe65f6e7748d373a8c57d7bfa-l5D3wU_fw658" title="头像" alt="头像"></a><div class="post-copyright__author_name">cgjil</div><div class="post-copyright__author_desc">你好啊，出发吧</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/')">错误异常处理与面向对象</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=undefined&amp;url=http://example.com/2022/10/28/%E7%BC%96%E7%A8%8B/%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/&amp;pic=undefined" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">cgjil</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E7%BC%96%E7%A8%8B/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>编程<span class="categoryesPageCount">7</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E8%AF%AD%E8%A8%80/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>语言<span class="tagsPageCount">6</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/10/22/%E7%BC%96%E7%A8%8B/python%E5%9F%BA%E7%A1%80/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/14.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">python基础</div></div></a></div><div class="next-post pull-right"><a href="/2022/11/03/%E7%BC%96%E7%A8%8B/exp/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/27.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">exp</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2022/10/10/%E7%BC%96%E7%A8%8B/php/" title="php基础"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/18.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-10-10</div><div class="title">php基础</div></div></a></div><div><a href="/2022/10/16/%E7%BC%96%E7%A8%8B/php%E5%87%BD%E6%95%B0/" title="php函数"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/29.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-10-16</div><div class="title">php函数</div></div></a></div><div><a href="/2022/10/13/%E7%BC%96%E7%A8%8B/php%E6%95%B0%E7%BB%84/" title="php数组"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/8.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-10-13</div><div class="title">php数组</div></div></a></div><div><a href="/2022/10/22/%E7%BC%96%E7%A8%8B/python%E5%9F%BA%E7%A1%80/" title="python基础"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/14.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-10-22</div><div class="title">python基础</div></div></a></div><div><a href="/2022/09/02/%E7%BC%96%E7%A8%8B/%E5%89%8D%E7%AB%AF/" title="前端"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/7.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-09-02</div><div class="title">前端</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hbimg.huaban.com/535ad5a8d0a1762fc1cbe65f6e7748d373a8c57d7bfa-l5D3wU_fw658" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" ait="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">This is my blog! **</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">出发吧，诗和远方</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">cgjil</h1><div class="author-info__desc">你好啊，出发吧</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/anzhiyu-c" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/372204786" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E5%BC%82%E5%B8%B8"><span class="toc-number">1.1.</span> <span class="toc-text">Python 异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%EF%BC%88%E6%8D%95%E8%8E%B7%EF%BC%89%E5%BC%82%E5%B8%B8"><span class="toc-number">1.2.</span> <span class="toc-text">检测（捕获）异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#try-except-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.3.</span> <span class="toc-text">try except 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8D%95%E8%8E%B7%E5%A4%9A%E7%A7%8D%E5%BC%82%E5%B8%B8"><span class="toc-number">1.4.</span> <span class="toc-text">捕获多种异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8D%95%E8%8E%B7%E6%89%80%E6%9C%89%E5%BC%82%E5%B8%B8"><span class="toc-number">1.5.</span> <span class="toc-text">捕获所有异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8"><span class="toc-number">1.6.</span> <span class="toc-text">处理异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E5%9C%BA%E6%99%AF"><span class="toc-number">1.7.</span> <span class="toc-text">特殊场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#with-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.8.</span> <span class="toc-text">with 语句</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%AD%98%E6%B4%BB%E6%A3%80%E6%B5%8B%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.</span> <span class="toc-text">内网主机存活检测程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#scapy-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.1.</span> <span class="toc-text">scapy 模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD"><span class="toc-number">2.2.</span> <span class="toc-text">主要功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scapy-%E5%AE%89%E8%A3%85"><span class="toc-number">2.3.</span> <span class="toc-text">scapy 安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E5%85%A5scapy-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.4.</span> <span class="toc-text">进入scapy 模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="toc-number">2.5.</span> <span class="toc-text">简单使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%AD%98%E6%B4%BB%E6%A3%80%E6%B5%8B%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.6.</span> <span class="toc-text">主机存活检测程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B"><span class="toc-number">3.</span> <span class="toc-text">面向对象编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB"><span class="toc-number">3.1.</span> <span class="toc-text">类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%B1%BB"><span class="toc-number">3.2.</span> <span class="toc-text">创建类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#init-%E6%96%B9%E6%B3%95"><span class="toc-number">3.3.</span> <span class="toc-text">init 方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-number">3.4.</span> <span class="toc-text">方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E6%96%B9%E6%B3%95"><span class="toc-number">3.5.</span> <span class="toc-text">绑定方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF"><span class="toc-number">3.6.</span> <span class="toc-text">继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E7%B1%BB%E7%BB%A7%E6%89%BF"><span class="toc-number">3.7.</span> <span class="toc-text">子类继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E9%87%8D%E5%86%99"><span class="toc-number">3.8.</span> <span class="toc-text">方法重写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF"><span class="toc-number">3.9.</span> <span class="toc-text">多重继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0"><span class="toc-number">3.10.</span> <span class="toc-text">魔法函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%92%8C%E5%AE%9E%E4%BE%8B%E7%9A%84%E5%86%85%E5%BB%BA%E5%87%BD%E6%95%B0"><span class="toc-number">3.11.</span> <span class="toc-text">类和实例的内建函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0"><span class="toc-number">3.12.</span> <span class="toc-text">常用的魔法函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%81%E6%9C%89%E5%8C%96"><span class="toc-number">3.13.</span> <span class="toc-text">私有化</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/11/28/%E6%BC%8F%E6%B4%9E/%E4%B8%9A%E5%8A%A1%E5%AE%89%E5%85%A8/" title="业务安全"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/21.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="业务安全"/></a><div class="content"><a class="title" href="/2022/11/28/%E6%BC%8F%E6%B4%9E/%E4%B8%9A%E5%8A%A1%E5%AE%89%E5%85%A8/" title="业务安全">业务安全</a><time datetime="2022-11-28T12:59:01.000Z" title="发表于 2022-11-28 20:59:01">2022-11-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/27/%E6%BC%8F%E6%B4%9E/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%EF%BC%88SSRF%EF%BC%89/" title="服务器请求伪造（SSRF）"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/4.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="服务器请求伪造（SSRF）"/></a><div class="content"><a class="title" href="/2022/11/27/%E6%BC%8F%E6%B4%9E/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%EF%BC%88SSRF%EF%BC%89/" title="服务器请求伪造（SSRF）">服务器请求伪造（SSRF）</a><time datetime="2022-11-27T12:59:57.000Z" title="发表于 2022-11-27 20:59:57">2022-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/24/%E6%BC%8F%E6%B4%9E/%E5%A4%B1%E6%95%88%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/" title="失效的访问控制"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/4.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="失效的访问控制"/></a><div class="content"><a class="title" href="/2022/11/24/%E6%BC%8F%E6%B4%9E/%E5%A4%B1%E6%95%88%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/" title="失效的访问控制">失效的访问控制</a><time datetime="2022-11-24T12:57:35.000Z" title="发表于 2022-11-24 20:57:35">2022-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/21/%E6%BC%8F%E6%B4%9E/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="反序列化"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/6.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="反序列化"/></a><div class="content"><a class="title" href="/2022/11/21/%E6%BC%8F%E6%B4%9E/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="反序列化">反序列化</a><time datetime="2022-11-21T12:58:40.000Z" title="发表于 2022-11-21 20:58:40">2022-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/19/%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" title="文件包含"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/22.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="文件包含"/></a><div class="content"><a class="title" href="/2022/11/19/%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" title="文件包含">文件包含</a><time datetime="2022-11-19T12:57:08.000Z" title="发表于 2022-11-19 20:57:08">2022-11-19</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>3</sup></a><a href="/tags/Windows/" style="font-size: 0.88rem;">Windows<sup>4</sup></a><a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size: 0.88rem;">脚本<sup>1</sup></a><a href="/tags/%E8%AF%AD%E8%A8%80/" style="font-size: 0.88rem;">语言<sup>6</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.6",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 cgjil 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const initWaline = () => {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://pinglun-ixrqfq3ea-xingloveyues-projects.vercel.app/',
      pageview: true,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: true,
    }, null))
  }

  const loadWaline = async () => {
    if (typeof Waline === 'object') initWaline()
    else {
      await getCSS('https://cdn.cbd.int/@waline/client@2.15.5/dist/waline.css')
      await getScript('https://cdn.cbd.int/@waline/client@2.15.5/dist/waline.js')
      initWaline()
    }
  }

  if ('Waline' === 'Waline' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = content => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = async () => {
    try {
      const res = await fetch('https://pinglun-ixrqfq3ea-xingloveyues-projects.vercel.app/api/comment?type=recent&count=6', { method: 'GET' })
      const result = await res.json()
      const walineArray = result.data.map(e => {
        return {
          'content': changeContent(e.comment),
          'avatar': e.avatar,
          'nick': e.nick,
          'url': e.url + '#' + e.objectId,
          'date': e.time || e.insertedAt
        }
      })
      saveToLocal.set('waline-newest-comments', JSON.stringify(walineArray), 10/(60*24))
      generateHtml(walineArray)
    } catch (err) {
      console.error(err)
      const $dom = document.querySelector('#card-newest-comments .aside-list')
      $dom.textContent= "无法获取评论，请确认相关配置是否正确"
    }
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('waline-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "visitor@anheyu.com";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="500" mobile="false" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="true"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>